%!TEX root = ../cleaning-vldb-16.tex
{\singlespacing
  \begin{algorithm}[t]\small
      \SetKwInOut{Input}{input}
      \SetKwInOut{Output}{output}
      
      \SetKwFunction{sinInRule}{singleInstanceRule}
      
	
      \SetKwData{mannot}{$\mathcal{M}_{annot}$}
	
      \Input{$G$ -- generation set}
      \Input{$V$ -- validation set}
      \Input{$R$ -- universe of rules}
      \Output{$R_{opt}$ -- greedy set cover solution}
      
      	$R_{opt} \gets \emptyset$\;
      	$r \gets \underset{w_m(r)}{\operatorname{argmin}}(r \in R)$\;
      	\Repeat{$R = \emptyset \vee C_{R_{opt}}(G) = G \vee w_m(r) \geq 0$}
      	{
      		$R_{opt} \gets R_{opt} \cup \{r\}$\;
      		$R \gets R \setminus \{r\}$\;
      		$r \gets \underset{w_m(r)}{\operatorname{argmin}}(r \in R)$\;
      	}
      	\If{$C_{R_{opt}}(G) \neq G$}{
      		$R_{opt} \gets R_{opt} \cup \sinInRule(G \setminus C_{R_{opt}}(G))$\;
      		
      	}
  
  \Return{$R_{opt}$}
  \caption{Greedy Rules Selection.}
  \label{alg:krd_greedy}
  \end{algorithm}
}